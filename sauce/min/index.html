<!doctype html>
<html lang=en data-bs-theme=dark>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0">
<title>OnlineIDE</title>
<link href=/bootstrap.min.css rel=stylesheet>
<link href=/styles.css rel=stylesheet>
<link rel=stylesheet href=/module/@xterm/xterm/css/xterm.css>
<script src=/module/@xterm/xterm/lib/xterm.js></script>
<script src=/module/@xterm/addon-fit/lib/addon-fit.js></script>
<link rel=icon type=image/png href=/favicon.png>
</head>
<body>
<div class=layout>
<div class=sidebar></div>
<div id=editor-wrapper>
<pre id=editor></pre>
</div>
<div class=overlay-panel>
<div class="btn-group btn-group-sm float-end" role=group aria-label=Actions style=z-index:1>
<button type=button class="btn btn-primary" id=run>Run</button>
<button type=button class="btn btn-warning" disabled id=stop>Stop</button>
<button type=button class="btn btn-secondary" disabled id=lang>Auto Detect</button>
<button type=button class="btn btn-secondary dropdown-toggle dropdown-toggle-split" data-bs-toggle=dropdown aria-expanded=false>
<span class=visually-hidden>Select Language</span>
</button>
<ul class=dropdown-menu>
<li><a class=dropdown-item id=lang-auto onclick='set("auto")'>Automatic detect</a></li>
<li>
<hr class=dropdown-divider>
</li>
</ul>
</div>
<div id=terminal></div>
</div>
</div>
<script src=/ace/ace.js></script>
<script src=/ace/ext-language_tools.js></script>
<script>"serviceWorker"in navigator&&window.addEventListener("load",(()=>navigator.serviceWorker.register("sw.js")))</script>
<script>function main(){var e=!0,n="",t="js";const o={js:"javascript",py:"python","g++":"c_cpp",c:"c_cpp",cpp:"c_cpp",gcc:"c_cpp",bash:"sh",shell:"sh"},a=ace.edit("editor");ace.require("ace/ext/language_tools"),a.setOptions({mode:"ace/mode/javascript",theme:"ace/theme/vibrant_ink",autoScrollEditorIntoView:!0,enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0});const i=new Terminal({convertEol:!0}),s=new FitAddon.FitAddon;function c(){const i=a.getValue();fetch("/api/classify",{method:"POST",body:i}).then((async i=>{const s=await i.text();"null"!==s&&404!==i.status&&(n=s,document.getElementById("lang-auto").innerText="Auto ("+s+")",e&&(document.getElementById("lang").innerText="Auto ("+s+")",a.session.setMode("ace/mode/"+(o[name]||name)),t=s))})),localStorage.setItem("code",i)}function l(i){e=!1,"auto"==i&&(e=!0,i=n||t),a.session.setMode("ace/mode/"+(o[i]||i)),t=i,document.getElementById("lang").innerHTML=this?.innerHTML||i}var r;i.loadAddon(s),i.open(document.getElementById("terminal")),s.fit(),i.write("[1;3;34mOnlineIDE[0m\n\nUniversal online code editor & compiler\nMade for Canandaigua Academy\n\nMore to come:\n- Multi file support\n- Language selection\n- More languages\n\nOnlineIDE@0.0.0-ALPHA\n 2024 @ Dreamnity inc."),a.session.on("change",(()=>{clearTimeout(window?.saveInterval),window.saveInterval=setTimeout(c,e?2e3:1e4)})),window.set=l,fetch("/api/list").then((e=>e.json())).then((e=>{const n=document.querySelector("ul.dropdown-menu"),t=/[^a-zA-Z0-9\-_]/g;for(const{language:o,aliases:a,version:i}of e){const e=(t.test(o)&&a.find((e=>!t.test(o)))||o).replace(/\+/g,"c"),s=document.createElement("li"),c=document.createElement("a");c.className="dropdown-item",c.id="lang-"+e,c.innerHTML=`${o} <sup>${i}</sup>`,c.onclick=()=>l(e),s.appendChild(c),n.appendChild(s)}})),i.onKey((({key:e})=>{r&&1===r?.readyState&&r.send(e)}));const d=document.getElementById("stop");d.onclick=()=>{r&&r.close(),d.disabled=!0};const m=document.getElementById("run");m.onclick=()=>{r&&r?.readyState<=1||(r=new WebSocket("/api/execute?lang="+t),m.innerText="...",r.onopen=()=>{m.classList.add("btn-warning"),m.innerText="30%",i.write("c"),r.send(a.getValue()),d.disabled=!1},r.onmessage=e=>{const n=e.data.toString();if("!!ready"!==n)if("!!starting"!==n){if("!!running"==n)return m.innerText="Running",m.classList.remove("btn-warning"),void m.classList.add("btn-success");if(n.startsWith("!!exit ")){if(n.endsWith(" 0"))return;console.error("Code failed with exit code "+n.substring(7))}else i.write(n)}else m.innerText="80%";else m.innerText="50%"},r.onerror=()=>i.write("[31m[client websocket error][0m"),r.onclose=()=>{m.innerText="Run",m.classList.remove("btn-success","btn-warning","btn-info"),d.disabled=!0,r=null})},localStorage.getItem("code")&&a.setValue(localStorage.getItem("code"))}main()</script>
<script src=/module/bootstrap/dist/js/bootstrap.bundle.min.js></script>
</body>
</html>